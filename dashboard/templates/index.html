<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Freerando Dashboard</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4/dist/chart.umd.min.js"></script>
</head>
<body>
    <header>
        <h1>Freerando Dashboard</h1>
        <div id="header-info">
            <span>yggdrasil</span>
            <span id="uptime">--</span>
            <span id="last-refresh">--</span>
        </div>
    </header>

    <main class="grid">
        <!-- CPU -->
        <section class="card">
            <h2>CPU</h2>
            <div id="cpu-temp" class="metric-big">--</div>
            <div class="metric-label">Temperature</div>
            <div class="metric-row" style="margin-top:0.5rem">
                <span>Usage</span>
                <strong id="cpu-percent">--%</strong>
            </div>
            <div class="metric-row">
                <span>Frequence</span>
                <strong id="cpu-freq">--</strong>
            </div>
            <div class="chart-container">
                <canvas id="chart-cpu"></canvas>
            </div>
            <div class="core-badges" id="cpu-cores"></div>
        </section>

        <!-- RAM -->
        <section class="card">
            <h2>Memoire</h2>
            <div id="ram-percent" class="metric-big">--%</div>
            <div class="metric-label" id="ram-detail">-- / --</div>
            <div class="chart-container">
                <canvas id="chart-ram"></canvas>
            </div>
        </section>

        <!-- Disks -->
        <section class="card">
            <h2>Disques</h2>
            <div id="disk-list"></div>
        </section>

        <!-- Network -->
        <section class="card">
            <h2>Reseau</h2>
            <div id="net-ips"></div>
            <div id="net-speed" style="margin-top:0.5rem"></div>
        </section>

        <!-- Docker -->
        <section class="card card-wide">
            <h2>Docker - icloudpd</h2>
            <div style="display:flex;align-items:center;gap:1rem;margin-bottom:0.5rem">
                <div id="docker-status"></div>
                <span id="docker-image" style="font-size:0.8rem;color:var(--text-secondary)"></span>
            </div>
            <div id="docker-uptime" style="font-size:0.8rem;color:var(--text-secondary);margin-bottom:0.5rem"></div>
            <div class="log-box" id="docker-logs">Chargement...</div>
        </section>

        <!-- PostgreSQL -->
        <section class="card">
            <h2>PostgreSQL (dev)</h2>
            <div id="pg-status"></div>
            <div id="pg-info" style="margin-top:0.5rem"></div>
            <table class="data-table" id="pg-tables"></table>
        </section>

        <!-- Photos -->
        <section class="card card-wide">
            <h2>iCloud Photos</h2>
            <div class="photo-stats">
                <div>
                    <div id="photo-count" class="metric-big">--</div>
                    <div class="metric-label">photos</div>
                </div>
                <div>
                    <div id="photo-size" style="font-size:1.4rem;font-weight:600;color:var(--accent-blue)">--</div>
                    <div class="metric-label">espace utilise</div>
                </div>
            </div>
            <div id="photo-extensions" style="font-size:0.75rem;color:var(--text-secondary);font-family:var(--font-mono);margin-bottom:0.5rem"></div>
            <div class="year-rows" id="photo-by-year"></div>
            <h3 style="font-size:0.85rem;color:var(--text-secondary);margin:0.8rem 0 0.3rem">Derniers fichiers</h3>
            <table class="data-table" id="photo-recent-table"></table>
        </section>
        <!-- Analysis Pipeline -->
        <section class="card card-full">
            <h2>Analyse des photos</h2>
            <div id="analysis-error" style="color:var(--accent-red);display:none"></div>
            <div class="analysis-grid">
                <div class="analysis-pipeline">
                    <h3 style="font-size:0.85rem;color:var(--text-secondary);margin-bottom:0.5rem">Pipeline</h3>
                    <div id="analysis-progress"></div>
                </div>
                <div class="analysis-tags">
                    <h3 style="font-size:0.85rem;color:var(--text-secondary);margin-bottom:0.5rem">Top tags CLIP</h3>
                    <div id="analysis-clip-tags"></div>
                </div>
                <div class="analysis-yolo">
                    <h3 style="font-size:0.85rem;color:var(--text-secondary);margin-bottom:0.5rem">Detections YOLO</h3>
                    <div id="analysis-yolo-tags"></div>
                </div>
                <div class="analysis-faces">
                    <h3 style="font-size:0.85rem;color:var(--text-secondary);margin-bottom:0.5rem">Visages</h3>
                    <div id="analysis-faces"></div>
                </div>
            </div>
        </section>
    </main>

    <script src="/static/js/charts.js"></script>
    <script src="/static/js/dashboard.js"></script>
</body>
</html>
